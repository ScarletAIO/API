const api = require("api")('@virustotal/v3.0#7r415jxl3ofbsw8');


export default new class Malware {
    private sdk = api; 
    private key = process.env.VIRUSTOTAL_API_KEY;


    async detect(file: string) {
        return await this.sdk.post('/files', {
            file: file
        }, {
            Accept: 'application/json',
            'x-apikey': this.key,
            'Content-Type': 'multipart/mixed'
        })
        .then((res) => {
            this.getAnalysis(res.data.id)
        })
        .catch((err) => {
            console.log(err);
        });
    }

    public async getAnalysis(id: string) {
        await this.sdk.analysis({
            id: id,
            'x-apikey': this.key
        })
        .then((res) => {
            return res.data
        })
        .catch((err) => {
            console.log(err);
        });
    }
}